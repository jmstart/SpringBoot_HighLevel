# SpringBoot之消息篇

一. 概述
    
    1.大多应用中，可通过消息服务中间件来提升系统异步通信、扩展解耦能力
    
    2.消息服务中两个重要概念：
        消息代理（message broker）和目的地（destination）
      当消息发送者发送消息以后，将由消息代理接管，消息代理保证消息传递到指定目的地。
    
    3.	消息队列主要有两种形式的目的地
    
      1.	队列（queue）：点对点消息通信（point-to-point）
      
      2.	主题（topic）：发布（publish）/订阅（subscribe）消息通信
      
    4.	点对点式：
      –	消息发送者发送消息，消息代理将其放入一个队列中，消息接收者从队列中获取消息内容，消息读取后被移出队列
      –	消息只有唯一的发送者和接受者，但并不是说只能有一个接收者
    
    5.	发布订阅式：
      –	发送者（发布者）发送消息到主题，多个接收者（订阅者）监听（订阅）这个主题，那么就会在消息到达时同时收到消息
    
    6.	JMS（Java Message Service）JAVA消息服务：
      –	基于JVM消息代理的规范。ActiveMQ、HornetMQ是JMS实现
    
    7.	AMQP（Advanced Message Queuing Protocol）
      –	高级消息队列协议，也是一个消息代理的规范，兼容JMS
      –	RabbitMQ是AMQP的实现


二. JMS & AQMP对比

                 JMS                                                    AQMP
    定义       Java api                                              网络线级协议
    跨语言        否                                                     是
    跨平台        否                                                     是
    Model      提供两种消息模型：                                   提供了五种消息模型：
                    （1）	、Peer-2-Peer                            (1)、direct exchange
                    （2）	、Pub/sub                                (2)、fanout exchange
                                                                  (3)、topic change
                                                                  (4)、headers exchange
                                                                  (5)、system exchange
                                                                 本质来讲，后四种和JMS的pub/sub模型没有太大差别，
                                                                 仅是在路由机制上做了更详细的划分;
                                                                 
    支持消息类型 多种消息类型：                                      byte[]
                TextMessage                                       当实际应用时，有复杂的消息，  
                MapMessage                                        可以将消息序列化后发送。                        
                BytesMessage StreamMessage ObjectMessage
                Message （只有消息头和属性）                                          
                
    综合评价     JMS 定义了JAVA API层面的标准；                       AMQP定义了wire-level层的协议标准；
                在java体系中，多个client均可以通过JMS进行交互，       天然具有跨平台、跨语言特性。                                 
                不需要应用修改代码，但是其对跨平台的支持较差；
                    
三. Spring的支持
    
    –	spring-jms提供了对JMS的支持
    
    –	spring-rabbit提供了对AMQP的支持
    
    –	需要ConnectionFactory的实现来连接消息代理
    
    –	提供JmsTemplate、RabbitTemplate来发送消息
    
    –	@JmsListener（JMS）、@RabbitListener（AMQP）注解在方法上监听消息代理发布的消息
    
    –	@EnableJms、@EnableRabbit开启支持

四. SpringBoot自动配置
  
    –	JmsAutoConfiguration
    
    –	RabbitAutoConfiguration
    
五. RabbitMQ简介
  
  1. RabbitMQ简介：
  
    RabbitMQ是一个由erlang开发的AMQP(Advanved Message Queue Protocol)的开源实现。
    
  2.核心概念
  
  1). Message
    
      消息，消息是不具名的，它由消息头和消息体组成。消息体是不透明的，而消息头则由一系列的可选属性组成，
    这些属性包括routing-key（路由键）、priority（相对于其他消息的优先权）、delivery-mode（指出该消息可能需要持久性存储）等。
    
  2). Publisher
    
    消息的生产者，也是一个向交换器发布消息的客户端应用程序。
  
  3). Exchange
    
      交换器，用来接收生产者发送的消息并将这些消息路由给服务器中的队列。
    Exchange有4种类型：direct(默认)，fanout, topic, 和headers，不同类型的Exchange转发消息的策略有所区别
  
  6.
  7.
  8.



六
七
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
